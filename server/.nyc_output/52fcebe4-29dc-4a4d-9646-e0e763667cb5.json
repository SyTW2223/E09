{"/home/marc/E09/server/src/app.ts":{"path":"/home/marc/E09/server/src/app.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":21}},"2":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":25}},"4":{"start":{"line":6,"column":21},"end":{"line":6,"column":52}},"5":{"start":{"line":7,"column":18},"end":{"line":7,"column":46}},"6":{"start":{"line":8,"column":22},"end":{"line":8,"column":54}},"7":{"start":{"line":9,"column":13},"end":{"line":9,"column":28}},"8":{"start":{"line":14,"column":0},"end":{"line":14,"column":24}},"9":{"start":{"line":15,"column":0},"end":{"line":15,"column":59}},"10":{"start":{"line":19,"column":0},"end":{"line":19,"column":32}},"11":{"start":{"line":23,"column":0},"end":{"line":23,"column":41}},"12":{"start":{"line":24,"column":0},"end":{"line":24,"column":43}},"13":{"start":{"line":25,"column":0},"end":{"line":25,"column":41}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"/home/marc/E09/server/src/app.ts","sources":["/home/marc/E09/server/src/app.ts"],"names":[],"mappings":";;;AAAA,mCAAmC;AACnC,yBAAuB;AACvB,qDAAgD;AAChD,+CAAgD;AAChD,uDAAkD;AAClD,MAAM,IAAI,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC;AAE7B;;;GAGG;AACU,QAAA,GAAG,GAAG,OAAO,EAAE,CAAC;AAC7B,WAAG,CAAC,GAAG,CAAC,IAAI,CAAC,EAAC,MAAM,EAAE,uBAAuB,EAAC,CAAC,CAAC,CAAC;AAEjD;;GAEG;AACH,WAAG,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC,CAAC;AAExB;;GAEG;AACH,WAAG,CAAC,GAAG,CAAC,uBAAU,CAAC,CAAC;AACpB,WAAG,CAAC,GAAG,CAAC,yBAAW,CAAC,CAAC;AACrB,WAAG,CAAC,GAAG,CAAC,uBAAa,CAAC,CAAC","sourcesContent":["import * as express from 'express';\nimport './db/mongoose';\nimport {userRouter} from './routers/userRouter';\nimport {defaultRouter} from './routers/default';\nimport {juiceRouter} from './routers/juiceRouter';\nconst cors = require('cors');\n\n/**\n * Creamos el servidor\n * 'app' variable de tipo Express\n */\nexport const app = express();\napp.use(cors({origin: 'http://localhost:8080'}));\n\n/**\n * Parsea el cuerpo de la petición\n */\napp.use(express.json());\n\n/**\n * Llamadas a las rutas\n */\napp.use(userRouter);\napp.use(juiceRouter);\napp.use(defaultRouter);"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"68eaa43d4206936ce7c0e72512a1d74d22838ba0","contentHash":"92a68db765b19c564a420b2d7a63c0bd8d4f8ef10391ffb76fd7b11b5b087125"},"/home/marc/E09/server/src/db/mongoose.ts":{"path":"/home/marc/E09/server/src/db/mongoose.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":19},"end":{"line":3,"column":38}},"2":{"start":{"line":4,"column":19},"end":{"line":4,"column":40}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":34}},"4":{"start":{"line":6,"column":0},"end":{"line":15,"column":3}},"5":{"start":{"line":12,"column":4},"end":{"line":12,"column":60}},"6":{"start":{"line":14,"column":4},"end":{"line":14,"column":56}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":11,"column":8},"end":{"line":11,"column":9}},"loc":{"start":{"line":11,"column":14},"end":{"line":13,"column":1}},"line":11},"1":{"name":"(anonymous_1)","decl":{"start":{"line":13,"column":9},"end":{"line":13,"column":10}},"loc":{"start":{"line":13,"column":15},"end":{"line":15,"column":1}},"line":13}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":0,"6":1},"f":{"0":0,"1":1},"b":{},"inputSourceMap":{"version":3,"file":"/home/marc/E09/server/src/db/mongoose.ts","sources":["/home/marc/E09/server/src/db/mongoose.ts"],"names":[],"mappings":";;AAAA,uCAAiC;AACjC,yCAAqC;AAErC,OAAO,CAAC,GAAG,CAAC,oBAAS,CAAC,CAAC;AACvB,IAAA,kBAAO,EAAC,OAAO,CAAC,GAAG,CAAC,YAAsB,EAAE;IAC1C,eAAe,EAAE,IAAI;IACrB,kBAAkB,EAAE,IAAI;IACxB,cAAc,EAAE,IAAI;IACpB,gBAAgB,EAAE,KAAK;CACxB,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE;IACX,OAAO,CAAC,GAAG,CAAC,0CAA0C,CAAC,CAAC;AAC1D,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,EAAE;IACZ,OAAO,CAAC,GAAG,CAAC,sCAAsC,CAAC,CAAC;AACtD,CAAC,CAAC,CAAC","sourcesContent":["import {connect} from 'mongoose';\nimport {remoteUrl} from './dbconfig';\n\nconsole.log(remoteUrl);\nconnect(process.env.DATABASE_URL as string, {\n  useNewUrlParser: true,\n  useUnifiedTopology: true,\n  useCreateIndex: true,\n  useFindAndModify: false,\n}).then(() => {\n  console.log('Connection to MongoDB server established');\n}).catch(() => {\n  console.log('Unnable to connect to MongoDB server');\n});\n\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"39757cef2d94917a7a28f0671cf61d9f5b31be46","contentHash":"25253d83f71e4b17ce6e3d79f81ab9c95415a07c202907954e140233c1b8cabb"},"/home/marc/E09/server/src/db/dbconfig.ts":{"path":"/home/marc/E09/server/src/db/dbconfig.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":27}},"2":{"start":{"line":4,"column":21},"end":{"line":4,"column":46}},"3":{"start":{"line":5,"column":21},"end":{"line":5,"column":46}},"4":{"start":{"line":6,"column":25},"end":{"line":6,"column":54}},"5":{"start":{"line":7,"column":21},"end":{"line":7,"column":46}},"6":{"start":{"line":8,"column":21},"end":{"line":8,"column":46}},"7":{"start":{"line":9,"column":31},"end":{"line":9,"column":70}},"8":{"start":{"line":10,"column":0},"end":{"line":10,"column":169}}},"fnMap":{},"branchMap":{"0":{"loc":{"start":{"line":10,"column":20},"end":{"line":10,"column":168}},"type":"binary-expr","locations":[{"start":{"line":10,"column":20},"end":{"line":10,"column":44}},{"start":{"line":10,"column":48},"end":{"line":10,"column":168}}],"line":10}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1},"f":{},"b":{"0":[1,1]},"inputSourceMap":{"version":3,"file":"/home/marc/E09/server/src/db/dbconfig.ts","sources":["/home/marc/E09/server/src/db/dbconfig.ts"],"names":[],"mappings":";;;AAAA,MAAM,YAAY,GAAW,OAAO,CAAC,GAAG,CAAC,aAAuB,CAAC;AACjE,MAAM,YAAY,GAAW,OAAO,CAAC,GAAG,CAAC,aAAuB,CAAC;AACjE,MAAM,gBAAgB,GAAW,OAAO,CAAC,GAAG,CAAC,iBAA2B,CAAC;AACzE,MAAM,YAAY,GAAW,OAAO,CAAC,GAAG,CAAC,aAAuB,CAAC;AACjE,MAAM,YAAY,GAAW,OAAO,CAAC,GAAG,CAAC,aAAuB,CAAC;AACjE,MAAM,sBAAsB,GAAW,OAAO,CAAC,GAAG,CAAC,2BAAqC,CAAC;AAE5E,QAAA,SAAS,GAAW,OAAO,CAAC,GAAG,CAAC,YAAsB,IAAE,aAAa,YAAY,IAAI,gBAAgB,IAAI,YAAY,GAAG,YAAY,IAAI,YAAY,IAAI,sBAAsB,EAAE,CAAC","sourcesContent":["const databaseUser: string = process.env.DATABASE_USER as string;\nconst databaseName: string = process.env.DATABASE_NAME as string;\nconst databasePassword: string = process.env.DATABASE_PASSWORD as string;\nconst databaseHost: string = process.env.DATABASE_HOST as string;\nconst databasePort: string = process.env.DATABASE_PORT as string;\nconst databaseConnectionOpts: string = process.env.DATABASE_CONNECTION_OPTIONS as string;\n\nexport const remoteUrl: string = process.env.DATABASE_URL as string||`mongodb://${databaseUser}:${databasePassword}@${databaseHost}${databasePort}/${databaseName}?${databaseConnectionOpts}`;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"398119653485506ebf90a77d5844fe4b3b96a90b","contentHash":"0716fe933bbc683195ca63af5306a41ff91dfc2edd588c04403c62af3d21c9b3"},"/home/marc/E09/server/src/routers/userRouter.ts":{"path":"/home/marc/E09/server/src/routers/userRouter.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":28}},"2":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"3":{"start":{"line":5,"column":15},"end":{"line":5,"column":40}},"4":{"start":{"line":6,"column":19},"end":{"line":6,"column":46}},"5":{"start":{"line":7,"column":18},"end":{"line":7,"column":44}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":38}},"7":{"start":{"line":10,"column":0},"end":{"line":13,"column":3}},"8":{"start":{"line":11,"column":17},"end":{"line":11,"column":42}},"9":{"start":{"line":12,"column":4},"end":{"line":12,"column":46}},"10":{"start":{"line":14,"column":0},"end":{"line":16,"column":3}},"11":{"start":{"line":15,"column":4},"end":{"line":15,"column":58}},"12":{"start":{"line":17,"column":0},"end":{"line":19,"column":3}},"13":{"start":{"line":18,"column":4},"end":{"line":18,"column":65}},"14":{"start":{"line":21,"column":0},"end":{"line":23,"column":3}},"15":{"start":{"line":22,"column":4},"end":{"line":22,"column":48}},"16":{"start":{"line":24,"column":0},"end":{"line":27,"column":3}},"17":{"start":{"line":25,"column":19},"end":{"line":25,"column":71}},"18":{"start":{"line":26,"column":4},"end":{"line":26,"column":52}},"19":{"start":{"line":29,"column":0},"end":{"line":41,"column":3}},"20":{"start":{"line":30,"column":27},"end":{"line":30,"column":39}},"21":{"start":{"line":31,"column":26},"end":{"line":31,"column":47}},"22":{"start":{"line":32,"column":26},"end":{"line":32,"column":90}},"23":{"start":{"line":32,"column":58},"end":{"line":32,"column":89}},"24":{"start":{"line":33,"column":4},"end":{"line":40,"column":5}},"25":{"start":{"line":34,"column":8},"end":{"line":36,"column":11}},"26":{"start":{"line":39,"column":8},"end":{"line":39,"column":65}},"27":{"start":{"line":42,"column":0},"end":{"line":59,"column":3}},"28":{"start":{"line":43,"column":27},"end":{"line":43,"column":78}},"29":{"start":{"line":44,"column":26},"end":{"line":44,"column":47}},"30":{"start":{"line":45,"column":26},"end":{"line":45,"column":90}},"31":{"start":{"line":45,"column":58},"end":{"line":45,"column":89}},"32":{"start":{"line":46,"column":4},"end":{"line":58,"column":5}},"33":{"start":{"line":47,"column":8},"end":{"line":49,"column":11}},"34":{"start":{"line":52,"column":8},"end":{"line":56,"column":9}},"35":{"start":{"line":53,"column":12},"end":{"line":55,"column":15}},"36":{"start":{"line":57,"column":8},"end":{"line":57,"column":55}},"37":{"start":{"line":61,"column":0},"end":{"line":68,"column":3}},"38":{"start":{"line":62,"column":4},"end":{"line":66,"column":5}},"39":{"start":{"line":63,"column":8},"end":{"line":65,"column":11}},"40":{"start":{"line":67,"column":4},"end":{"line":67,"column":54}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":10,"column":39},"end":{"line":10,"column":40}},"loc":{"start":{"line":10,"column":53},"end":{"line":13,"column":1}},"line":10},"1":{"name":"(anonymous_1)","decl":{"start":{"line":14,"column":39},"end":{"line":14,"column":40}},"loc":{"start":{"line":14,"column":53},"end":{"line":16,"column":1}},"line":14},"2":{"name":"(anonymous_2)","decl":{"start":{"line":17,"column":47},"end":{"line":17,"column":48}},"loc":{"start":{"line":17,"column":61},"end":{"line":19,"column":1}},"line":17},"3":{"name":"(anonymous_3)","decl":{"start":{"line":21,"column":36},"end":{"line":21,"column":37}},"loc":{"start":{"line":21,"column":50},"end":{"line":23,"column":1}},"line":21},"4":{"name":"(anonymous_4)","decl":{"start":{"line":24,"column":37},"end":{"line":24,"column":38}},"loc":{"start":{"line":24,"column":51},"end":{"line":27,"column":1}},"line":24},"5":{"name":"(anonymous_5)","decl":{"start":{"line":29,"column":48},"end":{"line":29,"column":49}},"loc":{"start":{"line":29,"column":62},"end":{"line":41,"column":1}},"line":29},"6":{"name":"(anonymous_6)","decl":{"start":{"line":32,"column":46},"end":{"line":32,"column":47}},"loc":{"start":{"line":32,"column":58},"end":{"line":32,"column":89}},"line":32},"7":{"name":"(anonymous_7)","decl":{"start":{"line":42,"column":39},"end":{"line":42,"column":40}},"loc":{"start":{"line":42,"column":53},"end":{"line":59,"column":1}},"line":42},"8":{"name":"(anonymous_8)","decl":{"start":{"line":45,"column":46},"end":{"line":45,"column":47}},"loc":{"start":{"line":45,"column":58},"end":{"line":45,"column":89}},"line":45},"9":{"name":"(anonymous_9)","decl":{"start":{"line":61,"column":40},"end":{"line":61,"column":41}},"loc":{"start":{"line":61,"column":54},"end":{"line":68,"column":1}},"line":61}},"branchMap":{"0":{"loc":{"start":{"line":25,"column":19},"end":{"line":25,"column":71}},"type":"cond-expr","locations":[{"start":{"line":25,"column":34},"end":{"line":25,"column":66}},{"start":{"line":25,"column":69},"end":{"line":25,"column":71}}],"line":25},"1":{"loc":{"start":{"line":33,"column":4},"end":{"line":40,"column":5}},"type":"if","locations":[{"start":{"line":33,"column":4},"end":{"line":40,"column":5}},{"start":{"line":33,"column":4},"end":{"line":40,"column":5}}],"line":33},"2":{"loc":{"start":{"line":46,"column":4},"end":{"line":58,"column":5}},"type":"if","locations":[{"start":{"line":46,"column":4},"end":{"line":58,"column":5}},{"start":{"line":46,"column":4},"end":{"line":58,"column":5}}],"line":46},"3":{"loc":{"start":{"line":52,"column":8},"end":{"line":56,"column":9}},"type":"if","locations":[{"start":{"line":52,"column":8},"end":{"line":56,"column":9}},{"start":{"line":52,"column":8},"end":{"line":56,"column":9}}],"line":52},"4":{"loc":{"start":{"line":62,"column":4},"end":{"line":66,"column":5}},"type":"if","locations":[{"start":{"line":62,"column":4},"end":{"line":66,"column":5}},{"start":{"line":62,"column":4},"end":{"line":66,"column":5}}],"line":62}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":1,"11":0,"12":1,"13":0,"14":1,"15":0,"16":1,"17":0,"18":0,"19":1,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":1,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":1,"38":0,"39":0,"40":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"inputSourceMap":{"version":3,"file":"/home/marc/E09/server/src/routers/userRouter.ts","sources":["/home/marc/E09/server/src/routers/userRouter.ts"],"names":[],"mappings":"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","sourcesContent":["import * as express from 'express';\nimport {User} from '../models/user';\nimport {UserCRUD} from '../crud/UserCRUD';\nimport { AppCRUD } from '../crud/AppCRUD';\n\nexport const userRouter = express.Router();\n\n// POST\nuserRouter.post('/api/signup', (req, res) => {\n  const user = new User(req.body);\n  UserCRUD.postSignUp(res, user);\n});\n\nuserRouter.post('/api/signin', (req, res) => {\n  UserCRUD.postSignIn(res, req, User);\n});\n\nuserRouter.post('/api/password-reset', (req, res) => {\n  UserCRUD.postPasswordReset(res, req, User);\n});\n\n// GET\nuserRouter.get('/api/user', (req, res) => {\n  UserCRUD.getLoggedUser(req, res);\n});\n\nuserRouter.get('/api/users', (req, res) => {\n  const filter = req.query.id?{_id: req.query.id.toString()}:{};\n  AppCRUD.get(res, filter, User);\n});\n\n// PATCH\nuserRouter.patch('/api/password-reset', (req, res) => {\n  const allowedUpdates = ['password'];\n  const actualUpdates = Object.keys(req.body);\n  const isValidUpdate =\n    actualUpdates.every((update) => allowedUpdates.includes(update));\n\n  if (!isValidUpdate) {\n    res.status(400).send({\n      error: 'Update is not permitted',\n    });\n  } else {\n    UserCRUD.patchPassword(req, res, User);\n  }\n});\n\n userRouter.patch('/api/users', (req, res) => {\n  const allowedUpdates = ['name', 'email', 'password', 'description', 'age'];\n  const actualUpdates = Object.keys(req.body);\n  const isValidUpdate =\n    actualUpdates.every((update) => allowedUpdates.includes(update));\n\n  if (!isValidUpdate) {\n    res.status(400).send({\n      error: 'Update is not permitted',\n    });\n  } else {\n    if (!req.query.id) {\n      res.status(400).send({\n        error: 'An id must be provided',\n      });\n    }\n    AppCRUD.patch(req, res, User);\n  }\n});\n\n// DELETE\nuserRouter.delete('/api/users', (req, res) => {\n  if (!req.query.id) {\n    res.status(400).send({\n      error: 'An id must be provided',\n    });\n  }\n  UserCRUD.delete(req, res, User);\n});"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"5fedf03b85c435483ba319a759cc3dfb422baa8c","contentHash":"da0ecfb06cac776334579872a6d70741eb57f2b096be97e1f319faaa966e0931"},"/home/marc/E09/server/src/models/user.ts":{"path":"/home/marc/E09/server/src/models/user.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":43}},"2":{"start":{"line":4,"column":19},"end":{"line":4,"column":38}},"3":{"start":{"line":5,"column":20},"end":{"line":5,"column":40}},"4":{"start":{"line":6,"column":0},"end":{"line":55,"column":3}},"5":{"start":{"line":19,"column":12},"end":{"line":21,"column":13}},"6":{"start":{"line":20,"column":16},"end":{"line":20,"column":51}},"7":{"start":{"line":29,"column":12},"end":{"line":31,"column":13}},"8":{"start":{"line":30,"column":16},"end":{"line":30,"column":61}},"9":{"start":{"line":56,"column":0},"end":{"line":56,"column":65}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":18,"column":18},"end":{"line":18,"column":19}},"loc":{"start":{"line":18,"column":29},"end":{"line":22,"column":9}},"line":18},"1":{"name":"(anonymous_1)","decl":{"start":{"line":28,"column":18},"end":{"line":28,"column":19}},"loc":{"start":{"line":28,"column":29},"end":{"line":32,"column":9}},"line":28}},"branchMap":{"0":{"loc":{"start":{"line":19,"column":12},"end":{"line":21,"column":13}},"type":"if","locations":[{"start":{"line":19,"column":12},"end":{"line":21,"column":13}},{"start":{"line":19,"column":12},"end":{"line":21,"column":13}}],"line":19},"1":{"loc":{"start":{"line":29,"column":12},"end":{"line":31,"column":13}},"type":"if","locations":[{"start":{"line":29,"column":12},"end":{"line":31,"column":13}},{"start":{"line":29,"column":12},"end":{"line":31,"column":13}}],"line":29}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":1},"f":{"0":0,"1":0},"b":{"0":[0,0],"1":[0,0]},"inputSourceMap":{"version":3,"file":"/home/marc/E09/server/src/models/user.ts","sources":["/home/marc/E09/server/src/models/user.ts"],"names":[],"mappings":";;;AAAA,uCAAiD;AACjD,yCAAkC;AAYrB,QAAA,UAAU,GAAG,IAAI,iBAAM,CAAwB;IAC1D,IAAI,EAAE;QACJ,IAAI,EAAE,MAAM;QACZ,MAAM,EAAE,IAAI;QACZ,QAAQ,EAAE,IAAI;QACd,IAAI,EAAE,IAAI;KACX;IACD,KAAK,EAAE;QACL,IAAI,EAAE,MAAM;QACZ,MAAM,EAAE,IAAI;QACZ,QAAQ,EAAE,IAAI;QACd,IAAI,EAAE,IAAI;QACV,QAAQ,EAAE,CAAC,KAAa,EAAE,EAAE;YAC1B,IAAI,CAAC,mBAAS,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;gBAC7B,MAAM,IAAI,KAAK,CAAC,iBAAiB,CAAC,CAAC;aACpC;QACH,CAAC;KACF;IACD,QAAQ,EAAE;QACR,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,IAAI;QACd,IAAI,EAAE,IAAI;QACV,QAAQ,EAAE,CAAC,KAAa,EAAE,EAAE;YAC1B,IAAI,CAAC,mBAAS,CAAC,gBAAgB,CAAC,KAAK,EAAE,EAAE,SAAS,EAAE,CAAC,EAAE,YAAY,EAAE,CAAC,EAAE,YAAY,EAAE,CAAC,EAAE,UAAU,EAAE,CAAC,EAAE,UAAU,EAAE,CAAC,EAAC,CAAC,EAAE;gBACvH,MAAM,IAAI,KAAK,CAAC,2BAA2B,CAAC,CAAC;aAC9C;QACH,CAAC;KACF;IACD,WAAW,EAAE;QACX,IAAI,EAAE,MAAM;QACZ,OAAO,EAAE,EAAE;QACX,MAAM,EAAE,KAAK;QACb,QAAQ,EAAE,KAAK;QACf,IAAI,EAAE,IAAI;KACX;IACD,SAAS,EAAE;QACT,IAAI,EAAE,MAAM;QACZ,OAAO,EAAE,CAAC;QACV,QAAQ,EAAE,IAAI;KACf;IACD,SAAS,EAAE;QACT,IAAI,EAAE,MAAM;QACZ,OAAO,EAAE,CAAC;QACV,QAAQ,EAAE,IAAI;KACf;IACD,GAAG,EAAE;QACH,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,KAAK;KAChB;CACF,CAAC,CAAC;AAEU,QAAA,IAAI,GAAG,IAAA,gBAAK,EAAwB,MAAM,EAAE,kBAAU,CAAC,CAAC","sourcesContent":["import {Document, Schema, model} from 'mongoose';\nimport validator from 'validator';\n\nexport interface UserDocumentInterface extends Document {\n  name: string,\n  email: string,\n  password: string,\n  description: string,\n  following: number,\n  followers: number,\n  age: number,\n}\n\nexport const UserSchema = new Schema<UserDocumentInterface>({\n  name: {\n    type: String,\n    unique: true,\n    required: true,\n    trim: true,\n  },\n  email: {\n    type: String,\n    unique: true,\n    required: true,\n    trim: true,\n    validate: (value: string) => {\n      if (!validator.isEmail(value)) {\n        throw new Error('Email not valid');\n      }\n    },\n  },\n  password: {\n    type: String,\n    required: true,\n    trim: true,\n    validate: (value: string) => {\n      if (!validator.isStrongPassword(value, { minLength: 8, minLowercase: 1, minUppercase: 1, minNumbers: 1, minSymbols: 0})) {\n        throw new Error('Must be a strong password');\n      }\n    },\n  },\n  description: {\n    type: String,\n    default: \"\",\n    unique: false,\n    required: false,\n    trim: true,\n  },\n  following: {\n    type: Number,\n    default: 0,\n    required: true,\n  },\n  followers: {\n    type: Number,\n    default: 0,\n    required: true,\n  },\n  age: {\n    type: Number,\n    required: false,\n  },\n});\n\nexport const User = model<UserDocumentInterface>('User', UserSchema);"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"a3b1f408ab66033690198ad98109815e06e5a8e8","contentHash":"b8d9b9dada8755c1a95984de947dbf660981cec6b94e4c62bb3c20137a2eb190"},"/home/marc/E09/server/src/crud/UserCRUD.ts":{"path":"/home/marc/E09/server/src/crud/UserCRUD.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":26}},"2":{"start":{"line":4,"column":12},"end":{"line":4,"column":35}},"3":{"start":{"line":5,"column":23},"end":{"line":5,"column":55}},"4":{"start":{"line":6,"column":20},"end":{"line":6,"column":49}},"5":{"start":{"line":9,"column":8},"end":{"line":15,"column":9}},"6":{"start":{"line":10,"column":12},"end":{"line":10,"column":33}},"7":{"start":{"line":11,"column":12},"end":{"line":11,"column":49}},"8":{"start":{"line":14,"column":12},"end":{"line":14,"column":57}},"9":{"start":{"line":18,"column":8},"end":{"line":36,"column":9}},"10":{"start":{"line":19,"column":28},"end":{"line":19,"column":103}},"11":{"start":{"line":20,"column":12},"end":{"line":32,"column":13}},"12":{"start":{"line":21,"column":16},"end":{"line":28,"column":19}},"13":{"start":{"line":22,"column":20},"end":{"line":27,"column":21}},"14":{"start":{"line":23,"column":24},"end":{"line":23,"column":68}},"15":{"start":{"line":26,"column":24},"end":{"line":26,"column":78}},"16":{"start":{"line":31,"column":16},"end":{"line":31,"column":102}},"17":{"start":{"line":35,"column":12},"end":{"line":35,"column":58}},"18":{"start":{"line":39,"column":8},"end":{"line":57,"column":9}},"19":{"start":{"line":40,"column":28},"end":{"line":40,"column":74}},"20":{"start":{"line":41,"column":12},"end":{"line":53,"column":13}},"21":{"start":{"line":42,"column":16},"end":{"line":49,"column":19}},"22":{"start":{"line":43,"column":20},"end":{"line":48,"column":21}},"23":{"start":{"line":44,"column":24},"end":{"line":44,"column":57}},"24":{"start":{"line":47,"column":24},"end":{"line":47,"column":68}},"25":{"start":{"line":52,"column":16},"end":{"line":52,"column":91}},"26":{"start":{"line":56,"column":12},"end":{"line":56,"column":58}},"27":{"start":{"line":60,"column":29},"end":{"line":60,"column":57}},"28":{"start":{"line":61,"column":8},"end":{"line":74,"column":9}},"29":{"start":{"line":62,"column":32},"end":{"line":62,"column":58}},"30":{"start":{"line":63,"column":12},"end":{"line":70,"column":15}},"31":{"start":{"line":64,"column":16},"end":{"line":69,"column":17}},"32":{"start":{"line":65,"column":20},"end":{"line":65,"column":84}},"33":{"start":{"line":68,"column":20},"end":{"line":68,"column":58}},"34":{"start":{"line":73,"column":12},"end":{"line":73,"column":83}},"35":{"start":{"line":77,"column":29},"end":{"line":77,"column":57}},"36":{"start":{"line":78,"column":8},"end":{"line":103,"column":9}},"37":{"start":{"line":79,"column":32},"end":{"line":79,"column":58}},"38":{"start":{"line":80,"column":12},"end":{"line":99,"column":15}},"39":{"start":{"line":81,"column":16},"end":{"line":98,"column":17}},"40":{"start":{"line":82,"column":20},"end":{"line":82,"column":84}},"41":{"start":{"line":85,"column":20},"end":{"line":97,"column":21}},"42":{"start":{"line":86,"column":40},"end":{"line":89,"column":26}},"43":{"start":{"line":90,"column":24},"end":{"line":92,"column":25}},"44":{"start":{"line":91,"column":28},"end":{"line":91,"column":93}},"45":{"start":{"line":93,"column":24},"end":{"line":93,"column":61}},"46":{"start":{"line":96,"column":24},"end":{"line":96,"column":67}},"47":{"start":{"line":102,"column":12},"end":{"line":102,"column":83}},"48":{"start":{"line":107,"column":29},"end":{"line":107,"column":57}},"49":{"start":{"line":108,"column":8},"end":{"line":133,"column":9}},"50":{"start":{"line":109,"column":32},"end":{"line":109,"column":58}},"51":{"start":{"line":110,"column":12},"end":{"line":129,"column":15}},"52":{"start":{"line":111,"column":16},"end":{"line":128,"column":17}},"53":{"start":{"line":112,"column":20},"end":{"line":112,"column":84}},"54":{"start":{"line":115,"column":20},"end":{"line":127,"column":21}},"55":{"start":{"line":116,"column":24},"end":{"line":118,"column":25}},"56":{"start":{"line":117,"column":28},"end":{"line":117,"column":84}},"57":{"start":{"line":119,"column":40},"end":{"line":119,"column":91}},"58":{"start":{"line":120,"column":24},"end":{"line":122,"column":25}},"59":{"start":{"line":121,"column":28},"end":{"line":121,"column":58}},"60":{"start":{"line":123,"column":24},"end":{"line":123,"column":61}},"61":{"start":{"line":126,"column":24},"end":{"line":126,"column":54}},"62":{"start":{"line":132,"column":12},"end":{"line":132,"column":83}},"63":{"start":{"line":136,"column":0},"end":{"line":136,"column":28}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":8,"column":4},"end":{"line":8,"column":5}},"loc":{"start":{"line":8,"column":42},"end":{"line":16,"column":5}},"line":8},"1":{"name":"(anonymous_1)","decl":{"start":{"line":17,"column":4},"end":{"line":17,"column":5}},"loc":{"start":{"line":17,"column":45},"end":{"line":37,"column":5}},"line":17},"2":{"name":"(anonymous_2)","decl":{"start":{"line":21,"column":78},"end":{"line":21,"column":79}},"loc":{"start":{"line":21,"column":94},"end":{"line":28,"column":17}},"line":21},"3":{"name":"(anonymous_3)","decl":{"start":{"line":38,"column":4},"end":{"line":38,"column":5}},"loc":{"start":{"line":38,"column":52},"end":{"line":58,"column":5}},"line":38},"4":{"name":"(anonymous_4)","decl":{"start":{"line":42,"column":76},"end":{"line":42,"column":77}},"loc":{"start":{"line":42,"column":92},"end":{"line":49,"column":17}},"line":42},"5":{"name":"(anonymous_5)","decl":{"start":{"line":59,"column":4},"end":{"line":59,"column":5}},"loc":{"start":{"line":59,"column":35},"end":{"line":75,"column":5}},"line":59},"6":{"name":"(anonymous_6)","decl":{"start":{"line":63,"column":49},"end":{"line":63,"column":50}},"loc":{"start":{"line":63,"column":68},"end":{"line":70,"column":13}},"line":63},"7":{"name":"(anonymous_7)","decl":{"start":{"line":76,"column":4},"end":{"line":76,"column":5}},"loc":{"start":{"line":76,"column":48},"end":{"line":104,"column":5}},"line":76},"8":{"name":"(anonymous_8)","decl":{"start":{"line":80,"column":49},"end":{"line":80,"column":50}},"loc":{"start":{"line":80,"column":74},"end":{"line":99,"column":13}},"line":80},"9":{"name":"(anonymous_9)","decl":{"start":{"line":106,"column":4},"end":{"line":106,"column":5}},"loc":{"start":{"line":106,"column":41},"end":{"line":134,"column":5}},"line":106},"10":{"name":"(anonymous_10)","decl":{"start":{"line":110,"column":49},"end":{"line":110,"column":50}},"loc":{"start":{"line":110,"column":74},"end":{"line":129,"column":13}},"line":110}},"branchMap":{"0":{"loc":{"start":{"line":20,"column":12},"end":{"line":32,"column":13}},"type":"if","locations":[{"start":{"line":20,"column":12},"end":{"line":32,"column":13}},{"start":{"line":20,"column":12},"end":{"line":32,"column":13}}],"line":20},"1":{"loc":{"start":{"line":22,"column":20},"end":{"line":27,"column":21}},"type":"if","locations":[{"start":{"line":22,"column":20},"end":{"line":27,"column":21}},{"start":{"line":22,"column":20},"end":{"line":27,"column":21}}],"line":22},"2":{"loc":{"start":{"line":41,"column":12},"end":{"line":53,"column":13}},"type":"if","locations":[{"start":{"line":41,"column":12},"end":{"line":53,"column":13}},{"start":{"line":41,"column":12},"end":{"line":53,"column":13}}],"line":41},"3":{"loc":{"start":{"line":43,"column":20},"end":{"line":48,"column":21}},"type":"if","locations":[{"start":{"line":43,"column":20},"end":{"line":48,"column":21}},{"start":{"line":43,"column":20},"end":{"line":48,"column":21}}],"line":43},"4":{"loc":{"start":{"line":61,"column":8},"end":{"line":74,"column":9}},"type":"if","locations":[{"start":{"line":61,"column":8},"end":{"line":74,"column":9}},{"start":{"line":61,"column":8},"end":{"line":74,"column":9}}],"line":61},"5":{"loc":{"start":{"line":64,"column":16},"end":{"line":69,"column":17}},"type":"if","locations":[{"start":{"line":64,"column":16},"end":{"line":69,"column":17}},{"start":{"line":64,"column":16},"end":{"line":69,"column":17}}],"line":64},"6":{"loc":{"start":{"line":78,"column":8},"end":{"line":103,"column":9}},"type":"if","locations":[{"start":{"line":78,"column":8},"end":{"line":103,"column":9}},{"start":{"line":78,"column":8},"end":{"line":103,"column":9}}],"line":78},"7":{"loc":{"start":{"line":81,"column":16},"end":{"line":98,"column":17}},"type":"if","locations":[{"start":{"line":81,"column":16},"end":{"line":98,"column":17}},{"start":{"line":81,"column":16},"end":{"line":98,"column":17}}],"line":81},"8":{"loc":{"start":{"line":90,"column":24},"end":{"line":92,"column":25}},"type":"if","locations":[{"start":{"line":90,"column":24},"end":{"line":92,"column":25}},{"start":{"line":90,"column":24},"end":{"line":92,"column":25}}],"line":90},"9":{"loc":{"start":{"line":108,"column":8},"end":{"line":133,"column":9}},"type":"if","locations":[{"start":{"line":108,"column":8},"end":{"line":133,"column":9}},{"start":{"line":108,"column":8},"end":{"line":133,"column":9}}],"line":108},"10":{"loc":{"start":{"line":111,"column":16},"end":{"line":128,"column":17}},"type":"if","locations":[{"start":{"line":111,"column":16},"end":{"line":128,"column":17}},{"start":{"line":111,"column":16},"end":{"line":128,"column":17}}],"line":111},"11":{"loc":{"start":{"line":116,"column":24},"end":{"line":118,"column":25}},"type":"if","locations":[{"start":{"line":116,"column":24},"end":{"line":118,"column":25}},{"start":{"line":116,"column":24},"end":{"line":118,"column":25}}],"line":116},"12":{"loc":{"start":{"line":120,"column":24},"end":{"line":122,"column":25}},"type":"if","locations":[{"start":{"line":120,"column":24},"end":{"line":122,"column":25}},{"start":{"line":120,"column":24},"end":{"line":122,"column":25}}],"line":120}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0]},"inputSourceMap":{"version":3,"file":"/home/marc/E09/server/src/crud/UserCRUD.ts","sources":["/home/marc/E09/server/src/crud/UserCRUD.ts"],"names":[],"mappings":"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","sourcesContent":["import * as jwt from 'jsonwebtoken';\nimport { UserDocumentInterface } from '../models/user';\nimport { handleErrors } from './assets/handleErrors';\nimport { sendEmail } from './assets/sendEmail';\n\nexport class UserCRUD {\n\n  public static async postSignUp(res: any, element: UserDocumentInterface) {\n    try {\n      await element.save();\n      return res.status(201).send(element);\n    } catch (error) {\n      handleErrors(error, res);\n    }\n  }\n \n  public static async postSignIn(res: any, req: any, model: any) {\n    try {\n      const element = await model.findOne({email:req.body.email, password:req.body.password});\n\n      if (element) {\n        jwt.sign({element}, 'secretkey', {'expiresIn': '86400s'}, (err: any, token: any) => {\n          if (err) {\n            return res.status(500).send({error: err});\n          } else {\n            return res.status(200).send({user: element, token});\n          }\n        });\n      } else {\n        return res.status(404).send({error:'Correo electrónico o contraseña incorrectos'});\n      }\n    } catch (error) {\n      return res.status(500).send({error: error});\n    }\n  }\n\n  public static async postPasswordReset(res: any, req: any, model: any) {\n    try {\n      const element = await model.findOne({email: req.body.email});\n\n      if (element) {\n        jwt.sign({element}, 'secretkey', {'expiresIn': '300s'}, (err: any, token: any) => {\n          if (err) {\n            return res.status(500).send(err);\n          } else {\n            sendEmail(res, req, token);\n          }\n        });\n      } else {\n        return res.status(404).send({error: 'Correo electrónico no registrado'});\n      }\n    } catch (error) {\n      return res.status(500).send({error: error});\n    }\n  }\n\n  public static getLoggedUser(req: any, res: any){\n    const bearerHeader =  req.headers['authorization'];\n\n    if (typeof bearerHeader !== 'undefined'){\n      const bearerToken = bearerHeader.split(\" \")[1];\n\n      jwt.verify(bearerToken, 'secretkey', (err: any, authData: any) => {\n        if (err){\n          return res.status(403).send({error: 'La sesión ha expirado'});\n        } else {\n          return res.status(200).send(authData);\n        }\n      });\n    } else {\n      return res.status(400).send({error: 'Debe proporcionarse un token'});\n    }\n  }\n\n  public static async patchPassword(req: any, res: any, model: any) {\n    const bearerHeader =  req.headers['authorization'];\n    if (typeof bearerHeader !== 'undefined') {\n      const bearerToken = bearerHeader.split(\" \")[1];\n\n      jwt.verify(bearerToken, 'secretkey', async (err: any, authData: any) => {\n        if (err) {\n          return res.status(403).send({error: 'La sesión ha expirado'});\n        } else {\n          try {\n            const element = await model.findByIdAndUpdate(authData.element._id, req.body, {\n              new: true,\n              runValidators: true,\n            });\n      \n            if (!element) {\n              return res.status(404).send({error: 'Elemento no encontrado'});\n            }\n        \n            return res.status(200).send(element);\n          } catch (err) {\n            handleErrors(err, res);\n          }\n        }\n      });\n    } else {\n      return res.status(400).send({error: 'Debe proporcionarse un token'});\n    }\n  }\n\n  // DELETE\n  public static async delete(req: any, res: any, model: any) {\n    const bearerHeader =  req.headers['authorization'];\n\n    if (typeof bearerHeader !== 'undefined'){\n      const bearerToken = bearerHeader.split(\" \")[1];\n\n      jwt.verify(bearerToken, 'secretkey', async (err: any, authData: any) => {\n        if (err){\n          return res.status(403).send({error: 'La sesión ha expirado'});\n        } else {\n          try {\n            if(authData.element._id !== req.query.id) {\n              return res.status(403).send('Eliminación no permitida');\n            }\n            const element = await model.findByIdAndDelete(authData.element._id);\n      \n            if (!element) {\n              return res.status(404).send();\n            }\n      \n            return res.status(200).send(element);\n          } catch (error) {\n            return res.status(400).send();\n          }\n        }\n      });\n    } else {\n      return res.status(400).send({error: 'Debe proporcionarse un token'});\n    }\n  }\n  \n}\n\n\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"18016699779fbe982abf88916b8e418c495c8a7f","contentHash":"7a69a747bcef56c38c4c72b89c4c0613ce7078cc944417ca183f2351f4f1b768"},"/home/marc/E09/server/src/crud/assets/handleErrors.ts":{"path":"/home/marc/E09/server/src/crud/assets/handleErrors.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":64}},"2":{"start":{"line":5,"column":4},"end":{"line":11,"column":61}},"3":{"start":{"line":6,"column":8},"end":{"line":6,"column":150}},"4":{"start":{"line":8,"column":9},"end":{"line":11,"column":61}},"5":{"start":{"line":9,"column":8},"end":{"line":9,"column":55}},"6":{"start":{"line":11,"column":8},"end":{"line":11,"column":61}},"7":{"start":{"line":13,"column":0},"end":{"line":13,"column":36}},"8":{"start":{"line":15,"column":18},"end":{"line":15,"column":43}},"9":{"start":{"line":16,"column":17},"end":{"line":16,"column":20}},"10":{"start":{"line":17,"column":16},"end":{"line":17,"column":24}},"11":{"start":{"line":18,"column":4},"end":{"line":23,"column":5}},"12":{"start":{"line":19,"column":8},"end":{"line":19,"column":25}},"13":{"start":{"line":22,"column":8},"end":{"line":22,"column":37}},"14":{"start":{"line":24,"column":4},"end":{"line":24,"column":94}},"15":{"start":{"line":26,"column":0},"end":{"line":26,"column":58}}},"fnMap":{"0":{"name":"handleErrors","decl":{"start":{"line":4,"column":9},"end":{"line":4,"column":21}},"loc":{"start":{"line":4,"column":32},"end":{"line":12,"column":1}},"line":4},"1":{"name":"handleDuplicateKeyError","decl":{"start":{"line":14,"column":9},"end":{"line":14,"column":32}},"loc":{"start":{"line":14,"column":43},"end":{"line":25,"column":1}},"line":14}},"branchMap":{"0":{"loc":{"start":{"line":5,"column":4},"end":{"line":11,"column":61}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":11,"column":61}},{"start":{"line":5,"column":4},"end":{"line":11,"column":61}}],"line":5},"1":{"loc":{"start":{"line":8,"column":9},"end":{"line":11,"column":61}},"type":"if","locations":[{"start":{"line":8,"column":9},"end":{"line":11,"column":61}},{"start":{"line":8,"column":9},"end":{"line":11,"column":61}}],"line":8},"2":{"loc":{"start":{"line":8,"column":13},"end":{"line":8,"column":42}},"type":"binary-expr","locations":[{"start":{"line":8,"column":13},"end":{"line":8,"column":21}},{"start":{"line":8,"column":25},"end":{"line":8,"column":42}}],"line":8},"3":{"loc":{"start":{"line":18,"column":4},"end":{"line":23,"column":5}},"type":"if","locations":[{"start":{"line":18,"column":4},"end":{"line":23,"column":5}},{"start":{"line":18,"column":4},"end":{"line":23,"column":5}}],"line":18}},"s":{"0":1,"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":1},"f":{"0":0,"1":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0]},"inputSourceMap":{"version":3,"file":"/home/marc/E09/server/src/crud/assets/handleErrors.ts","sources":["/home/marc/E09/server/src/crud/assets/handleErrors.ts"],"names":[],"mappings":";;;AACA,SAAgB,YAAY,CAAC,GAAQ,EAAE,GAAQ;IAC7C,IAAG,GAAG,CAAC,IAAI,KAAK,iBAAiB,EAAE;QACjC,OAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAC,KAAK,EAAE,iFAAiF,EAAE,MAAM,EAAE,UAAU,EAAC,CAAC,CAAC;KAC7I;SACI,IAAG,GAAG,CAAC,IAAI,IAAI,GAAG,CAAC,IAAI,IAAI,KAAK;QAAE,OAAO,GAAG,GAAG,uBAAuB,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;;QACjF,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAC,KAAK,EAAE,mBAAmB,EAAC,CAAC,CAAC;AAC1D,CAAC;AAND,oCAMC;AAED,SAAiB,uBAAuB,CAAC,GAAQ,EAAE,GAAQ;IACzD,MAAM,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;IACxC,MAAM,IAAI,GAAG,GAAG,CAAC;IACjB,IAAI,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;IACrB,IAAI,KAAK,KAAK,MAAM,EAAE;QACpB,KAAK,GAAG,QAAQ,CAAC;KAClB;SAAM;QACL,KAAK,GAAG,oBAAoB,CAAC;KAC9B;IACD,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,EAAC,KAAK,EAAE,gCAAgC,KAAK,GAAG,EAAE,MAAM,EAAE,KAAK,EAAC,CAAC,CAAC;AAC1F,CAAC;AAVD,0DAUC","sourcesContent":["\nexport function handleErrors(err: any, res: any) {\n  if(err.name === 'ValidationError') {\n    return res.status(400).send({error: \"La contraseña debe contener al menos ocho caracteres, un número y una mayúscula\", fields: 'password'});\n  }\n  else if(err.code && err.code == 11000) return err = handleDuplicateKeyError(err, res);\n  else res.status(500).send({error: 'Error desconocido'});\n}\n  \nexport  function handleDuplicateKeyError(err: any, res: any) {\n  const field = Object.keys(err.keyValue);\n  const code = 409;\n  var campo = field[0];\n  if (campo === 'name') {\n    campo = 'nombre';\n  } else {\n    campo = 'correo electrónico';\n  }\n  res.status(code).send({error: `Ya existe una cuenta con ese ${campo}.`, fields: field});\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"fd13c96014a51530f6631d7ac843183e3cbd9ba9","contentHash":"406ff917a5c9e396ec48dfcf4fbd3efd57abcd5ee80519b48a0561f552c9a2bf"},"/home/marc/E09/server/src/crud/assets/sendEmail.ts":{"path":"/home/marc/E09/server/src/crud/assets/sendEmail.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":27}},"2":{"start":{"line":4,"column":19},"end":{"line":4,"column":40}},"3":{"start":{"line":5,"column":13},"end":{"line":5,"column":42}},"4":{"start":{"line":6,"column":13},"end":{"line":6,"column":42}},"5":{"start":{"line":7,"column":13},"end":{"line":7,"column":31}},"6":{"start":{"line":8,"column":16},"end":{"line":8,"column":23}},"7":{"start":{"line":10,"column":4},"end":{"line":31,"column":5}},"8":{"start":{"line":11,"column":28},"end":{"line":20,"column":10}},"9":{"start":{"line":21,"column":8},"end":{"line":26,"column":11}},"10":{"start":{"line":27,"column":8},"end":{"line":27,"column":73}},"11":{"start":{"line":30,"column":8},"end":{"line":30,"column":43}},"12":{"start":{"line":33,"column":0},"end":{"line":33,"column":30}}},"fnMap":{"0":{"name":"sendEmail","decl":{"start":{"line":9,"column":15},"end":{"line":9,"column":24}},"loc":{"start":{"line":9,"column":42},"end":{"line":32,"column":1}},"line":9}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1},"f":{"0":0},"b":{},"inputSourceMap":{"version":3,"file":"/home/marc/E09/server/src/crud/assets/sendEmail.ts","sources":["/home/marc/E09/server/src/crud/assets/sendEmail.ts"],"names":[],"mappings":";;;AAAA,yCAAyC;AAEzC,MAAM,IAAI,GAAG,6BAA6B,CAAA,CAAA,aAAa;AACvD,MAAM,IAAI,GAAG,6BAA6B,CAAA,CAAA,WAAW;AACrD,MAAM,IAAI,GAAG,kBAAkB,CAAA,CAAA,iBAAiB;AAChD,MAAM,OAAO,GAAG,OAAO,CAAA,CAAA,gBAAgB;AAEhC,KAAK,UAAU,SAAS,CAAC,GAAQ,EAAE,GAAQ,EAAE,KAAa;IAC/D,IAAI;QACF,MAAM,WAAW,GAAG,UAAU,CAAC,eAAe,CAAC;YAC7C,IAAI,EAAE,IAAI;YACV,OAAO,EAAE,OAAO;YAChB,IAAI,EAAE,GAAG;YACT,MAAM,EAAE,IAAI;YACZ,IAAI,EAAE;gBACF,IAAI,EAAE,IAAI;gBACV,IAAI,EAAE,IAAI;aACb;SACF,CAAC,CAAC;QACH,MAAM,WAAW,CAAC,QAAQ,CAAC;YACzB,IAAI,EAAE,IAAI;YACV,EAAE,EAAE,GAAG,CAAC,IAAI,CAAC,KAAK;YAClB,OAAO,EAAE,gBAAgB;YACzB,IAAI,EAAE,0DAA0D,KAAK,EAAE;SACxE,CAAC,CAAC;QACH,OAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAC,IAAI,EAAC,yBAAyB,EAAC,CAAC,CAAC;KAE/D;IAAC,OAAO,KAAK,EAAE;QACd,OAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;KACpC;AACH,CAAC;AAvBD,8BAuBC","sourcesContent":["import * as nodemailer from 'nodemailer';\n\nconst HOST = 'juicerappofficial@gmail.com'// email host\nconst USER = 'juicerappofficial@gmail.com'// email id\nconst PASS = 'plsoovkmdwvujbgb'// email password\nconst SERVICE = 'Gmail'// email service\n\nexport async function sendEmail(res: any, req: any, token: string) {\n  try {\n    const transporter = nodemailer.createTransport({\n      host: HOST,\n      service: SERVICE,\n      port: 587,\n      secure: true,\n      auth: {\n          user: USER,\n          pass: PASS,\n      },\n    });\n    await transporter.sendMail({\n      from: USER,\n      to: req.body.email,\n      subject: 'Password reset',\n      text: `Click here to reset password: http://10.6.130.29/reset/${token}`,\n    });\n    return res.status(200).send({mssg:\"email sent successfully\"});\n\n  } catch (error) {\n    return res.status(500).send(error);\n  }\n}\n  \n  \n  \n  "]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c5488625d386f419b30c32df86c0714499c77437","contentHash":"1b08a8ba6b6ad7fce00d771d5800714605bee8e32f61b17045ec1181fe9fcc74"},"/home/marc/E09/server/src/crud/AppCRUD.ts":{"path":"/home/marc/E09/server/src/crud/AppCRUD.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":25}},"2":{"start":{"line":4,"column":12},"end":{"line":4,"column":35}},"3":{"start":{"line":8,"column":29},"end":{"line":8,"column":57}},"4":{"start":{"line":9,"column":8},"end":{"line":28,"column":9}},"5":{"start":{"line":10,"column":32},"end":{"line":10,"column":58}},"6":{"start":{"line":11,"column":12},"end":{"line":24,"column":15}},"7":{"start":{"line":12,"column":16},"end":{"line":23,"column":17}},"8":{"start":{"line":13,"column":20},"end":{"line":13,"column":84}},"9":{"start":{"line":16,"column":20},"end":{"line":22,"column":21}},"10":{"start":{"line":17,"column":24},"end":{"line":17,"column":45}},"11":{"start":{"line":18,"column":24},"end":{"line":18,"column":61}},"12":{"start":{"line":21,"column":24},"end":{"line":21,"column":70}},"13":{"start":{"line":27,"column":12},"end":{"line":27,"column":83}},"14":{"start":{"line":32,"column":8},"end":{"line":41,"column":9}},"15":{"start":{"line":33,"column":29},"end":{"line":33,"column":53}},"16":{"start":{"line":34,"column":12},"end":{"line":36,"column":13}},"17":{"start":{"line":35,"column":16},"end":{"line":35,"column":54}},"18":{"start":{"line":37,"column":12},"end":{"line":37,"column":66}},"19":{"start":{"line":40,"column":12},"end":{"line":40,"column":58}},"20":{"start":{"line":45,"column":29},"end":{"line":45,"column":57}},"21":{"start":{"line":46,"column":8},"end":{"line":71,"column":9}},"22":{"start":{"line":47,"column":32},"end":{"line":47,"column":58}},"23":{"start":{"line":48,"column":12},"end":{"line":67,"column":15}},"24":{"start":{"line":49,"column":16},"end":{"line":66,"column":17}},"25":{"start":{"line":50,"column":20},"end":{"line":50,"column":84}},"26":{"start":{"line":53,"column":20},"end":{"line":65,"column":21}},"27":{"start":{"line":54,"column":40},"end":{"line":57,"column":26}},"28":{"start":{"line":58,"column":24},"end":{"line":60,"column":25}},"29":{"start":{"line":59,"column":28},"end":{"line":59,"column":93}},"30":{"start":{"line":61,"column":24},"end":{"line":61,"column":61}},"31":{"start":{"line":64,"column":24},"end":{"line":64,"column":68}},"32":{"start":{"line":70,"column":12},"end":{"line":70,"column":83}},"33":{"start":{"line":75,"column":29},"end":{"line":75,"column":57}},"34":{"start":{"line":76,"column":8},"end":{"line":98,"column":9}},"35":{"start":{"line":77,"column":32},"end":{"line":77,"column":58}},"36":{"start":{"line":78,"column":12},"end":{"line":94,"column":15}},"37":{"start":{"line":79,"column":16},"end":{"line":93,"column":17}},"38":{"start":{"line":80,"column":20},"end":{"line":80,"column":84}},"39":{"start":{"line":83,"column":20},"end":{"line":92,"column":21}},"40":{"start":{"line":84,"column":40},"end":{"line":84,"column":83}},"41":{"start":{"line":85,"column":24},"end":{"line":87,"column":25}},"42":{"start":{"line":86,"column":28},"end":{"line":86,"column":58}},"43":{"start":{"line":88,"column":24},"end":{"line":88,"column":61}},"44":{"start":{"line":91,"column":24},"end":{"line":91,"column":54}},"45":{"start":{"line":97,"column":12},"end":{"line":97,"column":83}},"46":{"start":{"line":101,"column":0},"end":{"line":101,"column":26}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":7,"column":4},"end":{"line":7,"column":5}},"loc":{"start":{"line":7,"column":41},"end":{"line":29,"column":5}},"line":7},"1":{"name":"(anonymous_1)","decl":{"start":{"line":11,"column":49},"end":{"line":11,"column":50}},"loc":{"start":{"line":11,"column":64},"end":{"line":24,"column":13}},"line":11},"2":{"name":"(anonymous_2)","decl":{"start":{"line":31,"column":4},"end":{"line":31,"column":5}},"loc":{"start":{"line":31,"column":41},"end":{"line":42,"column":5}},"line":31},"3":{"name":"(anonymous_3)","decl":{"start":{"line":44,"column":4},"end":{"line":44,"column":5}},"loc":{"start":{"line":44,"column":40},"end":{"line":72,"column":5}},"line":44},"4":{"name":"(anonymous_4)","decl":{"start":{"line":48,"column":49},"end":{"line":48,"column":50}},"loc":{"start":{"line":48,"column":64},"end":{"line":67,"column":13}},"line":48},"5":{"name":"(anonymous_5)","decl":{"start":{"line":74,"column":4},"end":{"line":74,"column":5}},"loc":{"start":{"line":74,"column":41},"end":{"line":99,"column":5}},"line":74},"6":{"name":"(anonymous_6)","decl":{"start":{"line":78,"column":49},"end":{"line":78,"column":50}},"loc":{"start":{"line":78,"column":64},"end":{"line":94,"column":13}},"line":78}},"branchMap":{"0":{"loc":{"start":{"line":9,"column":8},"end":{"line":28,"column":9}},"type":"if","locations":[{"start":{"line":9,"column":8},"end":{"line":28,"column":9}},{"start":{"line":9,"column":8},"end":{"line":28,"column":9}}],"line":9},"1":{"loc":{"start":{"line":12,"column":16},"end":{"line":23,"column":17}},"type":"if","locations":[{"start":{"line":12,"column":16},"end":{"line":23,"column":17}},{"start":{"line":12,"column":16},"end":{"line":23,"column":17}}],"line":12},"2":{"loc":{"start":{"line":34,"column":12},"end":{"line":36,"column":13}},"type":"if","locations":[{"start":{"line":34,"column":12},"end":{"line":36,"column":13}},{"start":{"line":34,"column":12},"end":{"line":36,"column":13}}],"line":34},"3":{"loc":{"start":{"line":46,"column":8},"end":{"line":71,"column":9}},"type":"if","locations":[{"start":{"line":46,"column":8},"end":{"line":71,"column":9}},{"start":{"line":46,"column":8},"end":{"line":71,"column":9}}],"line":46},"4":{"loc":{"start":{"line":49,"column":16},"end":{"line":66,"column":17}},"type":"if","locations":[{"start":{"line":49,"column":16},"end":{"line":66,"column":17}},{"start":{"line":49,"column":16},"end":{"line":66,"column":17}}],"line":49},"5":{"loc":{"start":{"line":58,"column":24},"end":{"line":60,"column":25}},"type":"if","locations":[{"start":{"line":58,"column":24},"end":{"line":60,"column":25}},{"start":{"line":58,"column":24},"end":{"line":60,"column":25}}],"line":58},"6":{"loc":{"start":{"line":76,"column":8},"end":{"line":98,"column":9}},"type":"if","locations":[{"start":{"line":76,"column":8},"end":{"line":98,"column":9}},{"start":{"line":76,"column":8},"end":{"line":98,"column":9}}],"line":76},"7":{"loc":{"start":{"line":79,"column":16},"end":{"line":93,"column":17}},"type":"if","locations":[{"start":{"line":79,"column":16},"end":{"line":93,"column":17}},{"start":{"line":79,"column":16},"end":{"line":93,"column":17}}],"line":79},"8":{"loc":{"start":{"line":85,"column":24},"end":{"line":87,"column":25}},"type":"if","locations":[{"start":{"line":85,"column":24},"end":{"line":87,"column":25}},{"start":{"line":85,"column":24},"end":{"line":87,"column":25}}],"line":85}},"s":{"0":1,"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0]},"inputSourceMap":{"version":3,"file":"/home/marc/E09/server/src/crud/AppCRUD.ts","sources":["/home/marc/E09/server/src/crud/AppCRUD.ts"],"names":[],"mappings":"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","sourcesContent":["import {UserDocumentInterface} from '../models/user';\nimport { JuiceDocumentInterface } from '../models/juice';\nimport * as jwt from 'jsonwebtoken';\n\nexport class AppCRUD {\n\n  // POST\n  public static async post(req:any, res: any, element: UserDocumentInterface|JuiceDocumentInterface) {\n    const bearerHeader =  req.headers['authorization'];\n\n    if (typeof bearerHeader !== 'undefined'){\n      const bearerToken = bearerHeader.split(\" \")[1];\n\n      jwt.verify(bearerToken, 'secretkey', async (err: any) => {\n        if (err){\n          return res.status(403).send({error: 'La sesión ha expirado'});\n        } else {\n          try {\n            await element.save();\n            return res.status(201).send(element);\n          } catch (error) {\n            return res.status(400).send({error: error});\n          }\n        }\n      });\n    } else {\n      return res.status(400).send({error: 'Debe proporcionarse un token'});\n    }\n  }\n\n  // GET\n  public static async get(res: any, filter: any, model: any) {\n    try {\n      const elements = await model.find(filter);\n\n      if (elements.length !== 0) {\n        return res.status(200).send(elements);\n      }\n      return res.status(404).send('Elemento no encontrado');\n    } catch (error) {\n      return res.status(500).send({error: error});\n    }\n  }\n\n  // PATCH\n  public static async patch(req: any, res: any, model: any) {\n    const bearerHeader =  req.headers['authorization'];\n    if (typeof bearerHeader !== 'undefined') {\n      const bearerToken = bearerHeader.split(\" \")[1];\n\n      jwt.verify(bearerToken, 'secretkey', async (err: any) => {\n        if (err) {\n          return res.status(403).send({error: 'La sesión ha expirado'});\n        } else {\n          try {\n            const element = await model.findByIdAndUpdate(req.query.id, req.body, {\n              new: true,\n              runValidators: true,\n            });\n      \n            if (!element) {\n              return res.status(404).send({error: 'Elemento no encontrado'});\n            }\n        \n            return res.status(200).send(element);\n          } catch (err) {\n            return res.status(400).send({error: err});\n          }\n        }\n      });\n    } else {\n      return res.status(400).send({error: 'Debe proporcionarse un token'});\n    }\n  }\n\n  // DELETE\n  public static async delete(req: any, res: any, model: any) {\n    const bearerHeader =  req.headers['authorization'];\n\n    if (typeof bearerHeader !== 'undefined'){\n      const bearerToken = bearerHeader.split(\" \")[1];\n\n      jwt.verify(bearerToken, 'secretkey', async (err: any) => {\n        if (err){\n          return res.status(403).send({error: 'La sesión ha expirado'});\n        } else {\n          try {\n            const element = await model.findByIdAndDelete(req.query.id);\n      \n            if (!element) {\n              return res.status(404).send();\n            }\n      \n            return res.status(200).send(element);\n          } catch (error) {\n            return res.status(400).send();\n          }\n        }\n      });\n    } else {\n      return res.status(400).send({error: 'Debe proporcionarse un token'});\n    }\n  }\n\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c179835a15f0d02ac0e25f6de42db92515119f9a","contentHash":"476ae54096c544d40e0fccda0efe90324c15fd4f83d95ec175c7d2c337697e57"},"/home/marc/E09/server/src/routers/default.ts":{"path":"/home/marc/E09/server/src/routers/default.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":31}},"2":{"start":{"line":5,"column":16},"end":{"line":5,"column":34}},"3":{"start":{"line":6,"column":0},"end":{"line":6,"column":41}},"4":{"start":{"line":10,"column":0},"end":{"line":12,"column":3}},"5":{"start":{"line":11,"column":4},"end":{"line":11,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":10,"column":31},"end":{"line":10,"column":32}},"loc":{"start":{"line":10,"column":43},"end":{"line":12,"column":1}},"line":10}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":0},"f":{"0":0},"b":{},"inputSourceMap":{"version":3,"file":"/home/marc/E09/server/src/routers/default.ts","sources":["/home/marc/E09/server/src/routers/default.ts"],"names":[],"mappings":";;;AAAA,4BAA4B;AAC5B,mCAAmC;AAEtB,QAAA,aAAa,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC;AAE9C;;GAEG;AACH,qBAAa,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC,CAAC,EAAE,GAAG,EAAE,EAAE;IAChC,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,CAAC;AACzB,CAAC,CAAC,CAAC","sourcesContent":["/* eslint-disable new-cap */\nimport * as express from 'express';\n\nexport const defaultRouter = express.Router();\n\n/**\n * Ruta por defecto\n */\ndefaultRouter.all('*', (_, res) => {\n  res.status(501).send();\n});"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"063190e8bf4fee5a0c1c908fe48d8fd8d01508d7","contentHash":"0bb35574235ebd927849f18bd52683fb51ec0710f6ac82150b84b4dd967973d5"},"/home/marc/E09/server/src/routers/juiceRouter.ts":{"path":"/home/marc/E09/server/src/routers/juiceRouter.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":29}},"2":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"3":{"start":{"line":5,"column":18},"end":{"line":5,"column":44}},"4":{"start":{"line":6,"column":16},"end":{"line":6,"column":42}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":39}},"6":{"start":{"line":9,"column":0},"end":{"line":12,"column":3}},"7":{"start":{"line":10,"column":18},"end":{"line":10,"column":45}},"8":{"start":{"line":11,"column":4},"end":{"line":11,"column":44}},"9":{"start":{"line":14,"column":0},"end":{"line":17,"column":3}},"10":{"start":{"line":15,"column":19},"end":{"line":15,"column":72}},"11":{"start":{"line":16,"column":4},"end":{"line":16,"column":54}},"12":{"start":{"line":19,"column":0},"end":{"line":36,"column":3}},"13":{"start":{"line":20,"column":27},"end":{"line":20,"column":36}},"14":{"start":{"line":21,"column":26},"end":{"line":21,"column":47}},"15":{"start":{"line":22,"column":26},"end":{"line":22,"column":90}},"16":{"start":{"line":22,"column":58},"end":{"line":22,"column":89}},"17":{"start":{"line":23,"column":4},"end":{"line":35,"column":5}},"18":{"start":{"line":24,"column":8},"end":{"line":26,"column":11}},"19":{"start":{"line":29,"column":8},"end":{"line":33,"column":9}},"20":{"start":{"line":30,"column":12},"end":{"line":32,"column":15}},"21":{"start":{"line":34,"column":8},"end":{"line":34,"column":57}},"22":{"start":{"line":38,"column":0},"end":{"line":40,"column":3}},"23":{"start":{"line":39,"column":4},"end":{"line":39,"column":54}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":9,"column":39},"end":{"line":9,"column":40}},"loc":{"start":{"line":9,"column":53},"end":{"line":12,"column":1}},"line":9},"1":{"name":"(anonymous_1)","decl":{"start":{"line":14,"column":39},"end":{"line":14,"column":40}},"loc":{"start":{"line":14,"column":53},"end":{"line":17,"column":1}},"line":14},"2":{"name":"(anonymous_2)","decl":{"start":{"line":19,"column":45},"end":{"line":19,"column":46}},"loc":{"start":{"line":19,"column":59},"end":{"line":36,"column":1}},"line":19},"3":{"name":"(anonymous_3)","decl":{"start":{"line":22,"column":46},"end":{"line":22,"column":47}},"loc":{"start":{"line":22,"column":58},"end":{"line":22,"column":89}},"line":22},"4":{"name":"(anonymous_4)","decl":{"start":{"line":38,"column":42},"end":{"line":38,"column":43}},"loc":{"start":{"line":38,"column":56},"end":{"line":40,"column":1}},"line":38}},"branchMap":{"0":{"loc":{"start":{"line":15,"column":19},"end":{"line":15,"column":72}},"type":"cond-expr","locations":[{"start":{"line":15,"column":34},"end":{"line":15,"column":67}},{"start":{"line":15,"column":70},"end":{"line":15,"column":72}}],"line":15},"1":{"loc":{"start":{"line":23,"column":4},"end":{"line":35,"column":5}},"type":"if","locations":[{"start":{"line":23,"column":4},"end":{"line":35,"column":5}},{"start":{"line":23,"column":4},"end":{"line":35,"column":5}}],"line":23},"2":{"loc":{"start":{"line":29,"column":8},"end":{"line":33,"column":9}},"type":"if","locations":[{"start":{"line":29,"column":8},"end":{"line":33,"column":9}},{"start":{"line":29,"column":8},"end":{"line":33,"column":9}}],"line":29}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":1,"10":0,"11":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":1,"23":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0]},"inputSourceMap":{"version":3,"file":"/home/marc/E09/server/src/routers/juiceRouter.ts","sources":["/home/marc/E09/server/src/routers/juiceRouter.ts"],"names":[],"mappings":";;;AAAA,mCAAmC;AACnC,6CAA0C;AAC1C,2CAAwC;AAE3B,QAAA,WAAW,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC;AAE5C,OAAO;AACP,mBAAW,CAAC,IAAI,CAAC,YAAY,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE;IAC1C,MAAM,KAAK,GAAG,IAAI,aAAK,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;IAClC,iBAAO,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG,EAAE,KAAK,CAAC,CAAC;AAChC,CAAC,CAAC,CAAC;AAEH,MAAM;AACN,mBAAW,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE;IAC1C,MAAM,MAAM,GAAG,GAAG,CAAC,KAAK,CAAC,EAAE,CAAA,CAAC,CAAA,EAAC,IAAI,EAAE,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC,QAAQ,EAAE,EAAC,CAAA,CAAC,CAAA,EAAE,CAAC;IAC/D,iBAAO,CAAC,GAAG,CAAC,GAAG,EAAE,MAAM,EAAE,aAAK,CAAC,CAAC;AAClC,CAAC,CAAC,CAAC;AAEH,QAAQ;AACR,mBAAW,CAAC,KAAK,CAAC,iBAAiB,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE;IAChD,MAAM,cAAc,GAAG,CAAC,OAAO,CAAC,CAAC;IACjC,MAAM,aAAa,GAAG,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;IAC5C,MAAM,aAAa,GACjB,aAAa,CAAC,KAAK,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,cAAc,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC;IAEnE,IAAI,CAAC,aAAa,EAAE;QAClB,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;YACnB,KAAK,EAAE,yBAAyB;SACjC,CAAC,CAAC;KACJ;SAAM;QACL,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,EAAE;YACjB,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;gBACnB,KAAK,EAAE,wBAAwB;aAChC,CAAC,CAAC;SACJ;QACD,iBAAO,CAAC,KAAK,CAAC,GAAG,EAAE,GAAG,EAAE,aAAK,CAAC,CAAC;KAChC;AACH,CAAC,CAAC,CAAC;AAEH,SAAS;AACT,mBAAW,CAAC,MAAM,CAAC,aAAa,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE;IAC7C,iBAAO,CAAC,MAAM,CAAC,GAAG,EAAE,GAAG,EAAE,aAAK,CAAC,CAAC;AAClC,CAAC,CAAC,CAAC","sourcesContent":["import * as express from 'express';\nimport { AppCRUD } from '../crud/AppCRUD';\nimport { Juice } from '../models/juice';\n\nexport const juiceRouter = express.Router();\n\n// POST\njuiceRouter.post('/api/juice', (req, res) => {\n  const juice = new Juice(req.body);\n  AppCRUD.post(req, res, juice);\n});\n\n// GET\njuiceRouter.get('/api/juices', (req, res) => {\n  const filter = req.query.id?{name: req.query.id.toString()}:{};\n  AppCRUD.get(res, filter, Juice);\n});\n\n// PATCH\njuiceRouter.patch('/api/juice/like', (req, res) => {\n  const allowedUpdates = ['likes'];\n  const actualUpdates = Object.keys(req.body);\n  const isValidUpdate =\n    actualUpdates.every((update) => allowedUpdates.includes(update));\n\n  if (!isValidUpdate) {\n    res.status(400).send({\n      error: 'Update is not permitted',\n    });\n  } else {\n    if (!req.query.id) {\n      res.status(400).send({\n        error: 'An id must be provided',\n      });\n    }\n    AppCRUD.patch(req, res, Juice);\n  }\n});\n\n// DELETE\njuiceRouter.delete('/api/juices', (req, res) => {\n  AppCRUD.delete(req, res, Juice);\n});"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"7460bc86ea7d171887745abe3cbd86a216421b7b","contentHash":"55000c1755c71f9d75204af44655c33a1852a747f098101b39ad31a6be703d6d"},"/home/marc/E09/server/src/models/juice.ts":{"path":"/home/marc/E09/server/src/models/juice.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":45}},"2":{"start":{"line":4,"column":19},"end":{"line":4,"column":38}},"3":{"start":{"line":5,"column":0},"end":{"line":25,"column":3}},"4":{"start":{"line":26,"column":0},"end":{"line":26,"column":68}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"/home/marc/E09/server/src/models/juice.ts","sources":["/home/marc/E09/server/src/models/juice.ts"],"names":[],"mappings":";;;AAAA,uCAAiD;AAUpC,QAAA,WAAW,GAAG,IAAI,iBAAM,CAAyB;IAC5D,QAAQ,EAAE;QACR,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,IAAI;KACf;IACD,IAAI,EAAE;QACJ,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,IAAI;QACd,IAAI,EAAE,IAAI;KACX;IACD,IAAI,EAAE;QACJ,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,KAAK;QACf,IAAI,EAAE,IAAI;KACX;IACD,KAAK,EAAE;QACL,IAAI,EAAE,CAAC,MAAM,CAAC;QACd,OAAO,EAAE,EAAE;QACX,QAAQ,EAAE,KAAK;KAChB;CACF,CAAC,CAAC;AAEU,QAAA,KAAK,GAAG,IAAA,gBAAK,EAAyB,OAAO,EAAE,mBAAW,CAAC,CAAC","sourcesContent":["import {Document, Schema, model} from 'mongoose';\n// import validator from 'validator';\n\nexport interface JuiceDocumentInterface extends Document {\n  userName: string,\n  text: string,\n  date: string,\n  likes: [string]\n}\n\nexport const JuiceSchema = new Schema<JuiceDocumentInterface>({\n  userName: {\n    type: String,\n    required: true,\n  },\n  text: {\n    type: String,\n    required: true,\n    trim: true,\n  },\n  date: {\n    type: String,\n    required: false,\n    trim: true,\n  },\n  likes: {\n    type: [String],\n    default: [],\n    required: false,\n  }\n});\n\nexport const Juice = model<JuiceDocumentInterface>('Juice', JuiceSchema);"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"3565e949c7d80fdc28a864bfb483bbf211a6856d","contentHash":"32ea23b5a39ad1019eb5443d95e96e1bdeefad64e924d7ae585393a02f809928"}}